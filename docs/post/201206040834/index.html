<!DOCTYPE html>
<html lang="en">

<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <link rel="canonical" href="http://yut.hatenablog.com/entry/20120604/1338766462" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="">
  <meta name="generator" content="Hugo 0.55.4" />

  <title>初心者から見たPerl言語I/Fは気持ち悪いが、たった一行の記述が素晴らしく強力な件について &middot; Y&#39;s note</title>

  
  
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/pure-min.css">

  <!--[if lte IE 8]>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/grids-responsive-old-ie-min.css">
  <![endif]-->
  <!--[if gt IE 8]><!-->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/grids-responsive-min.css">
  <!--<![endif]-->

  <!--[if lte IE 8]>
  <link rel="stylesheet" href="https://yutakikuchi.github.io/css/side-menu-old-ie.css">
  <![endif]-->
  <!--[if gt IE 8]><!-->
  <link rel="stylesheet" href="https://yutakikuchi.github.io/blog/css/side-menu.css">
  <!--<![endif]-->

  <link rel="stylesheet" href="https://yutakikuchi.github.io/blog/css/blackburn.css">

  
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">

  
  <link href="https://fonts.googleapis.com/css?family=Raleway" rel="stylesheet" type="text/css">

  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

 
  

  
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/androidstudio.min.css">
  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
  
  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/yaml.min.js"></script>
  
  <script>hljs.initHighlightingOnLoad();</script>
  

  <link rel="shortcut icon" href="https://yutakikuchi.github.io/img/favicon.ico" type="image/x-icon" />

  
    
        <link rel="stylesheet" href="https://yutakikuchi.github.io/blog/css/my.css">
    
  
  
    
        <script src="https://yutakikuchi.github.io/blog/js/my.js"></script>
    
  

</head>


<body>
<div id="layout">

  
<a href="#menu" id="menuLink" class="menu-link">
  
  <span></span>
</a>
<div id="menu">

  
  <a class="pure-menu-heading brand" href="https://yutakikuchi.github.io/">Y's note</a>


  <div class="pure-menu">
    <ul class="pure-menu-list">
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://yutakikuchi.github.io/blog/"><i class='fa fa-home fa-fw'></i>Home</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://yutakikuchi.github.io/blog/post/"><i class='fa fa-list fa-fw'></i>Posts</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://yutakikuchi.github.io/blog/about/"><i class='fa fa-user fa-fw'></i>About</a>
      
        </li>
      
    </ul>
  </div>

  <div class="pure-menu social">
  <ul class="pure-menu-list">

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://twitter.com/yutakikuchi_" target="_blank"><i class="fa fa-twitter-square fa-fw"></i>Twitter</a>
    </li>
    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://facebook.com/yuta.kikuchi.007" target="_blank"><i class="fa fa-facebook-square fa-fw"></i>Facebook</a>
    </li>
    

    

    

    

    

    

    

    

    

    

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="http://slideshare.net/https://www.slideshare.net/yutakikuchi58/" target="_blank"><i class="fa fa-slideshare fa-fw"></i>SlideShare</a>
    </li>
    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://linkedin.com/in/https://www.linkedin.com/in/%E4%BD%91%E5%A4%AA-%E8%8F%8A%E6%B1%A0-36291a44/" target="_blank"><i class="fa fa-linkedin-square fa-fw"></i>LinkedIn</a>
    </li>
    

    

    

    

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://github.com/yutakikuchi" target="_blank"><i class="fa fa-github-square fa-fw"></i>GitHub</a>
    </li>
    

    

    

    

    

    

    

    

    

    

    

    

    

  </ul>
</div>


  <div>
  <div class="small-print">
    <small>&copy; 2019. All rights reserved.</small>
  </div>
  <div class="small-print">
    <small>Built with&nbsp;<a href="https://gohugo.io/" target="_blank">Hugo</a></small>
    <small>Theme&nbsp;<a href="https://github.com/yoshiharuyamashita/blackburn" target="_blank">Blackburn</a></small>
  </div>
</div>

</div>


  <div id="main">


<div class="header">
  <h1>初心者から見たPerl言語I/Fは気持ち悪いが、たった一行の記述が素晴らしく強力な件について</h1>
  <h2></h2>
</div>
<div class="content">

  <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>2012 Jun 04, 08:34</time>
  </div>

  

  

  

</div>

  

<h2 id="perl-初心者から見たperl言語i-fは気持ち悪いが-たった一行の記述が素晴らしく強力な件について">[Perl] : 初心者から見たPerl言語I/Fは気持ち悪いが、たった一行の記述が素晴らしく強力な件について</h2>

<p><div class="amazlet-box"><a href="http://www.amazon.co.jp/exec/obidos/ASIN/4873110963/yutakikuchi-22/"><img src="http://ecx.images-amazon.com/images/I/51EK7E5K5FL._SL160_.jpg" class="hatena-asin-detail-image" alt="プログラミングPerl〈VOLUME1〉" title="プログラミングPerl〈VOLUME1〉"></a><div class="hatena-asin-detail-info"><p class="hatena-asin-detail-title"><a href="http://www.amazon.co.jp/exec/obidos/ASIN/4873110963/yutakikuchi-22/">プログラミングPerl〈VOLUME1〉</a></p><ul><li><span class="hatena-asin-detail-label">作者:</span> ラリーウォール,ジョンオーワント,トムクリスチャンセン,<a class="keyword" href="http://d.hatena.ne.jp/keyword/Larry%20Wall">Larry Wall</a>,Jon Orwant,Tom Christiansen,近藤嘉雪</li><li><span class="hatena-asin-detail-label">出版社/メーカー:</span> <a class="keyword" href="http://d.hatena.ne.jp/keyword/%A5%AA%A5%E9%A5%A4%A5%EA%A1%BC%A1%A6%A5%B8%A5%E3%A5%D1%A5%F3">オライリー・ジャパン</a></li><li><span class="hatena-asin-detail-label">発売日:</span> 2002/09</li><li><span class="hatena-asin-detail-label">メディア:</span> 単行本</li><li><span class="hatena-asin-detail-label">購入</span>: 8人 <span class="hatena-asin-detail-label">クリック</span>: 245回</li><li><a href="http://d.hatena.ne.jp/asin/4873110963/yutakikuchi-22" target="_blank">この商品を含むブログ (130件) を見る</a></li></ul></div><div class="hatena-asin-detail-foot"></div></div></p>

<div class="section">
<h4>追記</h4>

<blockquote>
    <p>※2012/06/10 <a class="keyword" href="http://d.hatena.ne.jp/keyword/toku">toku</a>_bassさんからご指摘頂いた内容を載せておきます。</p>

<ul>
<li><a class="keyword" href="http://d.hatena.ne.jp/keyword/shebang">shebang</a>の定義は #!/usr/bin/env <a class="keyword" href="http://d.hatena.ne.jp/keyword/perl">perl</a>の方が都合が良い。</li>
<li><a class="keyword" href="http://d.hatena.ne.jp/keyword/%CF%A2%C1%DB%C7%DB%CE%F3">連想配列</a>の定義でkeyを''や""で囲まないとエラーになる。 
<ul>
<li>use strict無しでは''や""が無くてもそのまま実行されてしまいますが、use strictを使うと確かにエラーになる事を確認しました。よって必ずkeyは''や""で囲むべきです。</li>
</ul></li>
</ul><pre class="hljs perl" data-lang="perl" data-unlink> <span class="synComment">#!/usr/bin/env perl</span>
<span class="synStatement">use strict</span>;

<span class="synStatement">my</span> <span class="synIdentifier">%hash</span> = ( <span class="synConstant">'key0'</span>, <span class="synConstant">0</span>, <span class="synConstant">'key1'</span>, <span class="synConstant">1</span>, <span class="synConstant">'key2'</span> ,<span class="synConstant">2</span> );
<span class="synStatement">foreach</span>( <span class="synStatement">sort</span> <span class="synStatement">keys</span> <span class="synIdentifier">%hash</span> ) { 
<span class="synStatement">print</span> <span class="synConstant">"Key = </span><span class="synIdentifier">$_</span><span class="synConstant"> Value = </span><span class="synIdentifier">$hash{$_}</span><span class="synConstant"> </span><span class="synSpecial">\n</span><span class="synConstant">"</span>;
}
</pre>
<ul>
<li>arrayの連番定義は1..9等を使うと良い。</li>
<li>文字列の定義の場合はqw/ foo bar <a class="keyword" href="http://d.hatena.ne.jp/keyword/hoge">hoge</a> /を使うと良い。''などで囲むのが面倒なので。</li>
</ul><pre class="hljs perl" data-lang="perl" data-unlink> <span class="synComment">#!/usr/bin/env perl</span>

<span class="synStatement">use strict</span>;

<span class="synStatement">my</span> <span class="synIdentifier">@array</span> = ( <span class="synConstant">1</span> .. <span class="synConstant">9</span> );
<span class="synStatement">foreach</span> ( <span class="synIdentifier">@array</span> ) {
<span class="synStatement">print</span> <span class="synIdentifier">$_</span> . <span class="synConstant">"</span><span class="synSpecial">\n</span><span class="synConstant">"</span>;
}

<span class="synIdentifier">@array</span> = <span class="synConstant">qw/ foo bar hoge /</span>;
<span class="synStatement">foreach</span> ( <span class="synIdentifier">@array</span> ) {
<span class="synStatement">print</span> <span class="synIdentifier">$_</span> . <span class="synConstant">"</span><span class="synSpecial">\n</span><span class="synConstant">"</span>;
}
</pre>
<ul>
<li><a class="keyword" href="http://d.hatena.ne.jp/keyword/%CF%A2%C1%DB%C7%DB%CE%F3">連想配列</a>のkeyに配列の値、<a class="keyword" href="http://d.hatena.ne.jp/keyword/%CF%A2%C1%DB%C7%DB%CE%F3">連想配列</a>の値を1と定義したい場合は @hash{@array} = (1) x @arrayと書く事ができる。</li>
</ul><pre class="hljs perl" data-lang="perl" data-unlink> <span class="synComment">#!/usr/bin/env perl</span>
<span class="synStatement">use strict</span>;

<span class="synStatement">my</span> <span class="synIdentifier">@array</span> = ( <span class="synConstant">1</span> .. <span class="synConstant">9</span> );
<span class="synStatement">my</span> <span class="synIdentifier">%hash</span> = (); 
<span class="synIdentifier">@hash{@array}</span> = (<span class="synConstant">1</span>) x <span class="synIdentifier">@array</span>;
<span class="synStatement">foreach</span>( <span class="synStatement">sort</span> <span class="synStatement">keys</span> <span class="synIdentifier">%hash</span> ) { 
<span class="synStatement">print</span> <span class="synConstant">"Key = </span><span class="synIdentifier">$_</span><span class="synConstant"> Value = </span><span class="synIdentifier">$hash{$_}</span><span class="synConstant"> </span><span class="synSpecial">\n</span><span class="synConstant">"</span>;
}
</pre><pre class="code" data-lang="" data-unlink>Key = 1 Value = 1 
Key = 2 Value = 1 
Key = 3 Value = 1 
Key = 4 Value = 1 
Key = 5 Value = 1 
Key = 6 Value = 1 
Key = 7 Value = 1 
Key = 8 Value = 1 
Key = 9 Value = 1 </pre>
</blockquote>

</div>
<div class="section">
<h4><a class="keyword" href="http://d.hatena.ne.jp/keyword/Perl">Perl</a> <a class="keyword" href="http://d.hatena.ne.jp/keyword/%A5%D7%A5%ED%A5%B0%A5%E9%A5%DF%A5%F3%A5%B0%B8%C0%B8%EC">プログラミング言語</a>としてのInterFaceについて</h4>

<blockquote>
    <p><a class="keyword" href="http://d.hatena.ne.jp/keyword/Perl">Perl</a>を勉強中の<a href='https://twitter.com/#!/yutakikuc'>@yutakikuc</a>です。初めに断っておきますが決して<a class="keyword" href="http://d.hatena.ne.jp/keyword/Perl">Perl</a>をdisってはいません。初心者の観点から感じた事を書いてみます。初心者が<a class="keyword" href="http://d.hatena.ne.jp/keyword/Perl">Perl</a>を記述する上でイラつきを感じてしまうのが<span class="deco" style="color:#FF0000;">直感で文法の推測ができない</span>という点です。これは他の言語に精通していればいるほど気味の悪いものになると思います。それほどに<a class="keyword" href="http://d.hatena.ne.jp/keyword/Perl">Perl</a>の文法はとても特徴的です。例えば変数を宣言する時の配列(@)、ハッシュ(%)といった記号と実際にデータ要素を参照する時の<a class="keyword" href="http://d.hatena.ne.jp/keyword/%A5%B9%A5%AB%A5%E9%A1%BC">スカラー</a>($)を使用するという文法が気になります。(直感的には宣言時に使用した記号がそのまま使えると思ってしまう。)　また特殊変数($_など)への値展開が自動でされる場面があり、急に特殊変数の記述が出てきても何を示しているのかが分からないこと、unless( ifの否定 )やnext( ループのcontinue )、last( ループのbreak ) が特徴的....など他にも多数あります。まとめると初心者からすると<a class="keyword" href="http://d.hatena.ne.jp/keyword/Perl">Perl</a>のI/Fは分かりづらいといえます。しかしこれらの特徴的な文法を頭の中にしっかりと覚えてしまうと<a class="keyword" href="http://d.hatena.ne.jp/keyword/Perl">Perl</a>は非常に強力な<a class="keyword" href="http://d.hatena.ne.jp/keyword/%A5%C4%A1%BC%A5%EB">ツール</a>になるようです。この後で僕が勉強した<a class="keyword" href="http://d.hatena.ne.jp/keyword/Perl">Perl</a>の文法について紹介して行きます。また初めにプログラミング<a class="keyword" href="http://d.hatena.ne.jp/keyword/Perl">Perl</a>の冒頭に載っている著者/訳者の言葉をまとめておきます。</p>

<ul>
<li><span class="deco" style="font-style:italic;"><a class="keyword" href="http://d.hatena.ne.jp/keyword/Perl">Perl</a>はキュートである。キュートというには、いささか不格好なのだけれど。そう、ちょうどラクダみたいにね。</span></li>
<li><span class="deco" style="font-style:italic;"><a class="keyword" href="http://d.hatena.ne.jp/keyword/Perl">Perl</a>はあなたの仕事をするための言語である。</span></li>
<li><span class="deco" style="font-style:italic;">コンピュータ言語は、どんなことが可能であるかという点では大差はないものの、どんなことを簡単に行えるかという点では大きな違いがある。</span></li>
<li><span class="deco" style="font-style:italic;"><a class="keyword" href="http://d.hatena.ne.jp/keyword/Perl">Perl</a>を使う人々は、創造力が十分に発揮出来ると感じる。なぜなら、<a class="keyword" href="http://d.hatena.ne.jp/keyword/Perl">Perl</a>には「<a class="keyword" href="http://d.hatena.ne.jp/keyword/%C9%BD%B8%BD%A4%CE%BC%AB%CD%B3">表現の自由</a>」があるからだ。</span></li>
</ul>
</blockquote>

</div>
<div class="section">
<h4>配列と<a class="keyword" href="http://d.hatena.ne.jp/keyword/%CF%A2%C1%DB%C7%DB%CE%F3">連想配列</a>の定義</h4>

<blockquote>
    <p>配列と<a class="keyword" href="http://d.hatena.ne.jp/keyword/%CF%A2%C1%DB%C7%DB%CE%F3">連想配列</a>の定義が複雑なのが<a class="keyword" href="http://d.hatena.ne.jp/keyword/Perl">Perl</a>の特徴です。単純な定義は<span class="deco" style="color:#FF0000;">配列で@</span>、<span class="deco" style="color:#FF0000;"><a class="keyword" href="http://d.hatena.ne.jp/keyword/%CF%A2%C1%DB%C7%DB%CE%F3">連想配列</a>で%</span>を使って定義することが最もシンプルで分かりやすいですが、<span class="deco" style="color:#FF0000;"><a class="keyword" href="http://d.hatena.ne.jp/keyword/%A5%B9%A5%AB%A5%E9%A1%BC">スカラー</a>($)でリファレンスによる定義</span>をする記述もあります。<span class="deco" style="color:#FF0000;">リファレンスとは<a class="keyword" href="http://d.hatena.ne.jp/keyword/C%B8%C0%B8%EC">C言語</a>のポインタのようなもの</span>でデータの先頭番地のような値を参照することです。リファレンスから配列や<a class="keyword" href="http://d.hatena.ne.jp/keyword/%CF%A2%C1%DB%C7%DB%CE%F3">連想配列</a>形式の形に変換参照する事を<a class="keyword" href="http://d.hatena.ne.jp/keyword/%A5%C7%A5%EA%A5%D5%A5%A1%A5%EC%A5%F3%A5%B9">デリファレンス</a>と呼びます。これらを利用したシンプルな定義とリファレンスでの定義について下にまとめます。</p>

<div class="section">
<h5>配列のシンプルな定義</h5>
<p><span class="deco" style="color:#FF0000;">@(配列)または@(配列)と$(<a class="keyword" href="http://d.hatena.ne.jp/keyword/%A5%B9%A5%AB%A5%E9%A1%BC">スカラー</a>)を利用して配列を定義</span>します。パターン1の方が一般的な記述だと思います。出力はData::Dumperを利用するかforeachで回すと良いと思います。下ではforeachを利用しています。やや話が逸れますが、foreachなどの繰り返しを定義すると配列の要素を特殊変数($_)に自動で定義してくれます。これにより余計な変数定義が不要になります。</p>
<pre class="hljs perl" data-lang="perl" data-unlink><span class="synPreProc">#!/usr/local/bin/perl -w</span>

<span class="synStatement">use </span>Data::Dumper;

<span class="synComment"># パターン1</span>
<span class="synStatement">my</span> <span class="synIdentifier">@array</span> = ( <span class="synConstant">0</span>, <span class="synConstant">1</span>, <span class="synConstant">2</span> );

<span class="synComment"># パターン2</span>
<span class="synStatement">my</span> <span class="synIdentifier">@array</span> = ();
<span class="synIdentifier">$array[</span><span class="synConstant">0</span><span class="synIdentifier">]</span> = <span class="synConstant">0</span>;
<span class="synIdentifier">$array[</span><span class="synConstant">1</span><span class="synIdentifier">]</span> = <span class="synConstant">1</span>;
<span class="synIdentifier">$array[</span><span class="synConstant">2</span><span class="synIdentifier">]</span> = <span class="synConstant">2</span>;

<span class="synStatement">foreach</span>( <span class="synIdentifier">@array</span> ) {
<span class="synStatement">print</span> <span class="synIdentifier">$_</span> . <span class="synConstant">"</span><span class="synSpecial">\n</span><span class="synConstant">"</span>;  <span class="synComment">#要素を$_に自動的に展開してくれる</span>
}
<span class="synComment"># print Dumper @array;</span>
</pre>
</div>
<div class="section">
<h5>配列のリファレンス定義</h5>
<p>配列のリファレンスを参照するには\@arrayを利用します。リファレンスを代入するには<a class="keyword" href="http://d.hatena.ne.jp/keyword/%A5%B9%A5%AB%A5%E9%A1%BC">スカラー</a>($)を使います。リファレンスはただのアドレスなので、そのままforeachに渡すとエラーが出ます。foreach内で配列形式として参照するには配列の定義をそのまま入れるか、<a class="keyword" href="http://d.hatena.ne.jp/keyword/%A5%C7%A5%EA%A5%D5%A5%A1%A5%EC%A5%F3%A5%B9">デリファレンス</a>を使います。配列の<a class="keyword" href="http://d.hatena.ne.jp/keyword/%A5%C7%A5%EA%A5%D5%A5%A1%A5%EC%A5%F3%A5%B9">デリファレンス</a>は@{$array}のようになります。Data::Dumperの方はリファレンスをそのまま渡しても配列形式として出力します。</p>
<pre class="hljs perl" data-lang="perl" data-unlink><span class="synPreProc">#!/usr/local/bin/perl -w</span>

<span class="synStatement">use </span>Data::Dumper;

<span class="synStatement">print</span> <span class="synConstant">"----array---- </span><span class="synSpecial">\n</span><span class="synConstant">"</span>;

<span class="synStatement">my</span> <span class="synIdentifier">@array</span> = ( <span class="synConstant">0</span>, <span class="synConstant">1</span>, <span class="synConstant">2</span>); 

<span class="synComment"># リファレンスを代入</span>
<span class="synStatement">my</span> <span class="synIdentifier">$array_ref</span> = \<span class="synIdentifier">@array</span>;

<span class="synStatement">=pod</span><span class="synComment"> エラーになる定義</span>
<span class="synIdentifier">foreach( $array_ref )</span><span class="synComment"> {</span>
<span class="synPreProc">    print $_ . "\n";</span>
<span class="synComment">}</span>
<span class="synStatement">=cut</span>

<span class="synComment"># デリファレンスを行い、参照する</span>
<span class="synStatement">foreach</span>( <span class="synIdentifier">@{$array_ref}</span> ) { 
<span class="synStatement">print</span> <span class="synIdentifier">$_</span> . <span class="synConstant">"</span><span class="synSpecial">\n</span><span class="synConstant">"</span>;
}

<span class="synComment">#print Dumper $array_ref; エラーが発生する事なく正常に配列を出力</span>
</pre><pre class="code" data-lang="" data-unlink>----array---- 
0
1
2</pre>
</div>
<div class="section">
<h5>配列をリファレンスだけで定義する</h5>
<p><a class="keyword" href="http://d.hatena.ne.jp/keyword/%A5%B9%A5%AB%A5%E9%A1%BC">スカラー</a>のリファレンスを利用して@による配列自体をそのまま定義するのではなく、リファレンス型だけで定義する事ができます。リファレンス型で定義するには<span class="deco" style="color:#FF0000;">[]という無名配列生成子</span>を利用します。</p>
<pre class="hljs perl" data-lang="perl" data-unlink><span class="synPreProc">#!/usr/local/bin/perl -w</span>

<span class="synStatement">use </span>Data::Dumper;

<span class="synStatement">print</span> <span class="synConstant">"----array---- </span><span class="synSpecial">\n</span><span class="synConstant">"</span>;

<span class="synStatement">my</span> <span class="synIdentifier">$array_ref</span> = [ <span class="synConstant">0</span>, <span class="synConstant">1</span>, <span class="synConstant">2</span> ];
<span class="synStatement">foreach</span>( <span class="synIdentifier">@{$array_ref}</span> ) { 
<span class="synStatement">print</span> <span class="synIdentifier">$_</span> . <span class="synConstant">"</span><span class="synSpecial">\n</span><span class="synConstant">"</span>;
}

<span class="synComment">#print Dumper $array_ref;</span>
</pre><pre class="code" data-lang="" data-unlink>----array---- 
0
1
2</pre>
</div>
<div class="section">
<h5><a class="keyword" href="http://d.hatena.ne.jp/keyword/%CF%A2%C1%DB%C7%DB%CE%F3">連想配列</a>をシンプルに定義する</h5>
<p><span class="deco" style="color:#FF0000;"><a class="keyword" href="http://d.hatena.ne.jp/keyword/%CF%A2%C1%DB%C7%DB%CE%F3">連想配列</a>の定義には%</span>を利用します。パターン1か3が一般的な記述で、パターン2のkey/valueをカンマで区切るのは可読性が落ちると思います。foreachで回す場合はkeysにより<a class="keyword" href="http://d.hatena.ne.jp/keyword/%CF%A2%C1%DB%C7%DB%CE%F3">連想配列</a>のkeyを取得します。取得したkeyは自動的に特殊変数$_に展開され、値は<a class="keyword" href="http://d.hatena.ne.jp/keyword/%A5%B9%A5%AB%A5%E9%A1%BC">スカラー</a>を使い$hash{$_}のように参照します。keyの値はデフォルトではsortされていないので、昇順にする場合はsort関数を利用します。</p>
<pre class="hljs perl" data-lang="perl" data-unlink><span class="synPreProc">#!/usr/local/bin/perl -w</span>

<span class="synStatement">print</span> <span class="synConstant">"----hash---- </span><span class="synSpecial">\n</span><span class="synConstant">"</span>;
<span class="synComment"># パターン1</span>
<span class="synStatement">my</span> <span class="synIdentifier">%hash</span> = ( <span class="synConstant">key0</span> => <span class="synConstant">0</span>, <span class="synConstant">key1</span> => <span class="synConstant">1</span>, <span class="synConstant">key2</span> => <span class="synConstant">2</span> );
<span class="synComment"># パターン2</span>
<span class="synStatement">my</span> <span class="synIdentifier">%hash</span> = ( key0, <span class="synConstant">0</span>, key1, <span class="synConstant">1</span>, key2, <span class="synConstant">2</span> );
<span class="synComment"># パターン3</span>
<span class="synStatement">my</span> <span class="synIdentifier">%hash</span>;
<span class="synIdentifier">$hash{</span><span class="synConstant">key0</span><span class="synIdentifier">}</span> = <span class="synConstant">0</span>;
<span class="synIdentifier">$hash{</span><span class="synConstant">key1</span><span class="synIdentifier">}</span> = <span class="synConstant">1</span>;
<span class="synIdentifier">$hash{</span><span class="synConstant">key2</span><span class="synIdentifier">}</span> = <span class="synConstant">2</span>;

<span class="synStatement">foreach</span>( <span class="synStatement">sort</span> <span class="synStatement">keys</span> <span class="synIdentifier">%hash</span> ) {
<span class="synStatement">print</span> <span class="synConstant">"Key = </span><span class="synIdentifier">$_</span><span class="synConstant">  Value = </span><span class="synIdentifier">$hash{$_}</span><span class="synConstant"> </span><span class="synSpecial">\n</span><span class="synConstant">"</span>;
}
</pre><pre class="code" data-lang="" data-unlink>----hash---- 
Key = key0  Value = 0 
Key = key1  Value = 1 
Key = key2  Value = 2 </pre>
</div>
<div class="section">
<h5><a class="keyword" href="http://d.hatena.ne.jp/keyword/%CF%A2%C1%DB%C7%DB%CE%F3">連想配列</a>のリファレンス定義</h5>
<p>配列と同様にリファレンスを定義します。<a class="keyword" href="http://d.hatena.ne.jp/keyword/%CF%A2%C1%DB%C7%DB%CE%F3">連想配列</a>のリファレンスを参照するには\%hashと定義します。<a class="keyword" href="http://d.hatena.ne.jp/keyword/%A5%C7%A5%EA%A5%D5%A5%A1%A5%EC%A5%F3%A5%B9">デリファレンス</a>にする場合は%{$hash_ref}とします。リファレンスから値を参照する時にはアラー<a class="keyword" href="http://d.hatena.ne.jp/keyword/%B1%E9%BB%BB%BB%D2">演算子</a>(->)を利用します。</p>
<pre class="hljs perl" data-lang="perl" data-unlink><span class="synPreProc">#!/usr/local/bin/perl -w</span>

<span class="synStatement">print</span> <span class="synConstant">"----hash---- </span><span class="synSpecial">\n</span><span class="synConstant">"</span>;
<span class="synStatement">my</span> <span class="synIdentifier">%hash</span> = ( <span class="synConstant">key0</span> => <span class="synConstant">0</span>, <span class="synConstant">key1</span> => <span class="synConstant">1</span>, <span class="synConstant">key2</span> => <span class="synConstant">2</span> );
<span class="synStatement">my</span> <span class="synIdentifier">$hash_ref</span> = \<span class="synIdentifier">%hash</span>;

<span class="synStatement">foreach</span>( <span class="synStatement">sort</span> <span class="synStatement">keys</span> <span class="synIdentifier">%{$hash_ref}</span> ) {
<span class="synStatement">print</span> <span class="synConstant">"Key = </span><span class="synIdentifier">$_</span><span class="synConstant">  Value = </span><span class="synIdentifier">$hash_ref->{$_}</span><span class="synConstant"> </span><span class="synSpecial">\n</span><span class="synConstant">"</span>;
}
</pre><pre class="code" data-lang="" data-unlink>----hash---- 
Key = key0  Value = 0 
Key = key1  Value = 1 
Key = key2  Value = 2 </pre>
</div>
<div class="section">
<h5><a class="keyword" href="http://d.hatena.ne.jp/keyword/%CF%A2%C1%DB%C7%DB%CE%F3">連想配列</a>をリファレンスだけで定義する</h5>
<p>配列と同様にリファレンスだけで<a class="keyword" href="http://d.hatena.ne.jp/keyword/%CF%A2%C1%DB%C7%DB%CE%F3">連想配列</a>を定義することができます。<a class="keyword" href="http://d.hatena.ne.jp/keyword/%CF%A2%C1%DB%C7%DB%CE%F3">連想配列</a>をリファレンスだけで定義する場合は無名ハッシュ生成子({})を利用します。</p>
<pre class="hljs perl" data-lang="perl" data-unlink><span class="synPreProc">#!/usr/local/bin/perl -w</span>

<span class="synStatement">print</span> <span class="synConstant">"----hash---- </span><span class="synSpecial">\n</span><span class="synConstant">"</span>;
<span class="synStatement">my</span> <span class="synIdentifier">$hash_ref</span> = { <span class="synConstant">key0</span> => <span class="synConstant">0</span>, <span class="synConstant">key1</span> => <span class="synConstant">1</span>, <span class="synConstant">key2</span> => <span class="synConstant">2</span> };
<span class="synStatement">foreach</span>( <span class="synStatement">sort</span> <span class="synStatement">keys</span> <span class="synIdentifier">%{$hash_ref}</span> ) {
<span class="synStatement">print</span> <span class="synConstant">"Key = </span><span class="synIdentifier">$_</span><span class="synConstant">  Value = </span><span class="synIdentifier">$hash_ref->{$_}</span><span class="synConstant"> </span><span class="synSpecial">\n</span><span class="synConstant">"</span>;
}
</pre>
</div>
</blockquote>

</div>
<div class="section">
<h4>配列/<a class="keyword" href="http://d.hatena.ne.jp/keyword/%CF%A2%C1%DB%C7%DB%CE%F3">連想配列</a>テクニック</h4>

<blockquote>
    
<div class="section">
<h5><a class="keyword" href="http://d.hatena.ne.jp/keyword/%CF%A2%C1%DB%C7%DB%CE%F3">連想配列</a>の中に配列を追加する</h5>
<p><a class="keyword" href="http://d.hatena.ne.jp/keyword/%CF%A2%C1%DB%C7%DB%CE%F3">連想配列</a>を定義して特定のkey以下に配列を追加したい場合は配列のpush関数を利用します。注意としてpush関数の第一引数は配列を指定する必要があるため、<span class="deco" style="color:#FF0000;">@{\%hash{key}}</span>のように配列形式で定義します。<a class="keyword" href="http://d.hatena.ne.jp/keyword/%CF%A2%C1%DB%C7%DB%CE%F3">連想配列</a>をpush関数の第一引数として渡すと当然エラーになります。<a class="keyword" href="http://d.hatena.ne.jp/keyword/%CF%A2%C1%DB%C7%DB%CE%F3">連想配列</a>の中に単純に配列を定義したい場合は<span class="deco" style="color:#FF0000;">$hash{key} = [@array];</span>のように定義する事もできますが、この記述では配列要素の再追加はできません。再追加にはpushが必要になります。</p>
<pre class="hljs perl" data-lang="perl" data-unlink><span class="synPreProc">#!/usr/local/bin/perl -w</span>

<span class="synStatement">my</span> <span class="synIdentifier">%hash</span> = ();
<span class="synIdentifier">$hash{</span><span class="synConstant">key</span><span class="synIdentifier">}</span> = ();
<span class="synStatement">my</span> <span class="synIdentifier">@array</span> = (<span class="synConstant">1</span>,<span class="synConstant">2</span>,<span class="synConstant">3</span>);

<span class="synComment">#配列を連想配列に追加</span>
<span class="synStatement">push</span>( <span class="synIdentifier">@{$hash{</span><span class="synConstant">key</span><span class="synIdentifier">}}</span>, <span class="synIdentifier">@array</span> );

<span class="synComment">#更に配列を追加</span>
<span class="synStatement">my</span> <span class="synIdentifier">@array2</span> = (<span class="synConstant">4</span>,<span class="synConstant">5</span>,<span class="synConstant">6</span>);
<span class="synComment">#下を定義すると前の要素が消えてしまう。よって再追加するにはpushが必要。</span>
<span class="synComment">#$hash{key} = [ @array2 ];</span>
<span class="synStatement">push</span>( <span class="synIdentifier">@{$hash{</span><span class="synConstant">key</span><span class="synIdentifier">}}</span>, <span class="synIdentifier">@array2</span> );

<span class="synStatement">foreach</span> <span class="synStatement">my</span> <span class="synIdentifier">$key</span> ( <span class="synStatement">sort</span> <span class="synStatement">keys</span> <span class="synIdentifier">%hash</span> ) {
<span class="synStatement">print</span> <span class="synConstant">"Key = </span><span class="synIdentifier">$key</span><span class="synConstant"> </span><span class="synSpecial">\n</span><span class="synConstant">"</span>;
<span class="synStatement">foreach</span>( <span class="synIdentifier">@{$hash{$key}}</span> ) {
    <span class="synStatement">print</span> <span class="synConstant">"Value = </span><span class="synIdentifier">$_</span><span class="synConstant"> </span><span class="synSpecial">\n</span><span class="synConstant">"</span>;
}
}
</pre><pre class="code" data-lang="" data-unlink>Key = key 
Value = 1 
Value = 2 
Value = 3 
Value = 4 
Value = 5 
Value = 6 </pre>
</div>
<div class="section">
<h5>配列の要素を検索する</h5>
<p>配列に含まれている要素を検索するには一般的には<a class="keyword" href="http://d.hatena.ne.jp/keyword/grep">grep</a>を利用します。<a class="keyword" href="http://d.hatena.ne.jp/keyword/grep">grep</a>以外の方法としてはhashのkeyに配列の値を展開してdefinedでチェックする方法があります。<a class="keyword" href="http://d.hatena.ne.jp/keyword/%CF%A2%C1%DB%C7%DB%CE%F3">連想配列</a>の場合も同様に<a class="keyword" href="http://d.hatena.ne.jp/keyword/grep">grep</a>を使ってkeyや値が含まれているかを検索します。<a class="keyword" href="http://d.hatena.ne.jp/keyword/%CF%A2%C1%DB%C7%DB%CE%F3">連想配列</a>ではkeysやvaluesを使ってそれぞれの配列を取得する必要があります。</p>
<pre class="hljs perl" data-lang="perl" data-unlink><span class="synPreProc">#!/usr/local/bin/perl -w</span>

<span class="synStatement">my</span> <span class="synIdentifier">@array</span> = (<span class="synConstant">1</span>,<span class="synConstant">2</span>,<span class="synConstant">3</span>,<span class="synConstant">4</span>,<span class="synConstant">5</span>,<span class="synConstant">6</span>,<span class="synConstant">7</span>,<span class="synConstant">8</span>,<span class="synConstant">9</span>);
<span class="synStatement">if</span>( <span class="synStatement">grep{</span> <span class="synIdentifier">$_</span> == <span class="synConstant">5</span> <span class="synStatement">}</span> <span class="synIdentifier">@array</span> ) {
<span class="synStatement">print</span> <span class="synConstant">"exists 5 in array </span><span class="synSpecial">\n</span><span class="synConstant">"</span>;
}

<span class="synStatement">if</span>( <span class="synStatement">grep{</span> <span class="synIdentifier">$_</span> == <span class="synConstant">10</span> <span class="synStatement">}</span> <span class="synIdentifier">@array</span> ) {
<span class="synStatement">print</span> <span class="synConstant">"exists 10 in array </span><span class="synSpecial">\n</span><span class="synConstant">"</span>;
}

<span class="synStatement">my</span> <span class="synIdentifier">%hash</span>;
<span class="synIdentifier">$hash{$_}</span> = <span class="synConstant">1</span> <span class="synStatement">for</span> <span class="synIdentifier">@array</span>;

<span class="synStatement">if</span> ( <span class="synStatement">defined</span> <span class="synIdentifier">$hash{</span><span class="synConstant">5</span><span class="synIdentifier">}</span> ) {
<span class="synStatement">print</span> <span class="synConstant">"exists 5 in array </span><span class="synSpecial">\n</span><span class="synConstant">"</span>;
}

<span class="synStatement">if</span> ( <span class="synStatement">defined</span> <span class="synIdentifier">$hash{</span><span class="synConstant">10</span><span class="synIdentifier">}</span> ) {
<span class="synStatement">print</span> <span class="synConstant">"exists 10 in array </span><span class="synSpecial">\n</span><span class="synConstant">"</span>;
}
</pre><pre class="code" data-lang="" data-unlink>exists 5 in array 
exists 5 in array </pre><pre class="hljs perl" data-lang="perl" data-unlink><span class="synPreProc">#!/usr/local/bin/perl -w</span>

<span class="synStatement">my</span> <span class="synIdentifier">%hash</span> = ( <span class="synConstant">key0</span> => <span class="synConstant">'value0'</span>, <span class="synConstant">key1</span> => <span class="synConstant">'value1'</span>, <span class="synConstant">key2</span> => <span class="synConstant">'value2'</span> );

<span class="synStatement">if</span>( <span class="synStatement">grep{</span> <span class="synIdentifier">$_</span> <span class="synStatement">eq</span> <span class="synConstant">'key1'</span> <span class="synStatement">}</span> <span class="synStatement">keys</span> <span class="synIdentifier">%hash</span> ) {
<span class="synStatement">print</span> <span class="synConstant">"exists key1 in hash </span><span class="synSpecial">\n</span><span class="synConstant">"</span>;
}

<span class="synStatement">if</span>( <span class="synStatement">grep{</span> <span class="synIdentifier">$_</span> <span class="synStatement">eq</span> <span class="synConstant">'value1'</span> <span class="synStatement">}</span> <span class="synStatement">values</span> <span class="synIdentifier">%hash</span> ) {
<span class="synStatement">print</span> <span class="synConstant">"exists value1 in hash </span><span class="synSpecial">\n</span><span class="synConstant">"</span>;
}

<span class="synStatement">if</span>( <span class="synStatement">grep{</span> <span class="synIdentifier">$_</span> <span class="synStatement">eq</span> <span class="synConstant">'key3'</span> <span class="synStatement">}</span> <span class="synStatement">keys</span> <span class="synIdentifier">%hash</span> ) {
<span class="synStatement">print</span> <span class="synConstant">"exists key3 in hash </span><span class="synSpecial">\n</span><span class="synConstant">"</span>;
}

<span class="synStatement">if</span>( <span class="synStatement">grep{</span> <span class="synIdentifier">$_</span> <span class="synStatement">eq</span> <span class="synConstant">'value3'</span> <span class="synStatement">}</span> <span class="synStatement">values</span> <span class="synIdentifier">%hash</span> ) {
<span class="synStatement">print</span> <span class="synConstant">"exists value3 in hash </span><span class="synSpecial">\n</span><span class="synConstant">"</span>;
}
</pre><pre class="code" data-lang="" data-unlink>exists key1 in hash 
exists value1 in hash</pre>
</div>
<div class="section">
<h5>配列から重複要素を削除</h5>
<p>配列から重複要素を削除する場合にも<span class="deco" style="color:#FF0000;"><a class="keyword" href="http://d.hatena.ne.jp/keyword/grep">grep</a>と<a class="keyword" href="http://d.hatena.ne.jp/keyword/%CF%A2%C1%DB%C7%DB%CE%F3">連想配列</a></span>を利用します。<a class="keyword" href="http://d.hatena.ne.jp/keyword/%CF%A2%C1%DB%C7%DB%CE%F3">連想配列</a>のkeyに配列の値、<a class="keyword" href="http://d.hatena.ne.jp/keyword/%CF%A2%C1%DB%C7%DB%CE%F3">連想配列</a>の値に配列中の個数を代入していきます。<a class="keyword" href="http://d.hatena.ne.jp/keyword/%CF%A2%C1%DB%C7%DB%CE%F3">連想配列</a>中の値の個数が0であれば配列に格納するという手段で重複値が削除されます。下に例を示しますがこのコードを自分で思いつくのは至難の業であり、<a class="keyword" href="http://d.hatena.ne.jp/keyword/Perl">Perl</a>の黒魔術的な性質を感じさせますが、使い方さえ覚えてしまえばとても便利だと言えます。</p>
<pre class="hljs perl" data-lang="perl" data-unlink><span class="synPreProc">#!/usr/local/bin/perl -w</span>

<span class="synStatement">my</span> <span class="synIdentifier">@array</span> = ( <span class="synConstant">'perl'</span>, <span class="synConstant">'php'</span>, <span class="synConstant">'java'</span>, <span class="synConstant">'java'</span>, <span class="synConstant">'php'</span> );
<span class="synStatement">my</span> <span class="synIdentifier">%count</span>;
<span class="synIdentifier">@array</span> = <span class="synStatement">grep {</span> !<span class="synIdentifier">$count{$_}</span>++ <span class="synStatement">}</span> <span class="synIdentifier">@array</span>;
<span class="synStatement">foreach</span>( <span class="synIdentifier">@array</span> ) { 
<span class="synStatement">print</span> <span class="synIdentifier">$_</span> . <span class="synConstant">"</span><span class="synSpecial">\n</span><span class="synConstant">"</span>
}
</pre><pre class="code" data-lang="" data-unlink>perl
php
java</pre>
</div>
</blockquote>

</div>
<div class="section">
<h4>Links</h4>

<blockquote>
    
<ul>
<li><a href="http://perldoc.jp/">perldoc.jp</a> <a href="http://b.hatena.ne.jp/entry/perldoc.jp/"><img src="http://b.hatena.ne.jp/entry/image/http://perldoc.jp/" alt="はてなブックマーク - perldoc.jp" border="0" /></a></li>
<li><a href="http://d.hatena.ne.jp/perlcodesample/">サンプルコードによるPerl入門</a> <a href="http://b.hatena.ne.jp/entry/d.hatena.ne.jp/perlcodesample/"><img src="http://b.hatena.ne.jp/entry/image/http://d.hatena.ne.jp/perlcodesample/" alt="はてなブックマーク - サンプルコードによるPerl入門" border="0" /></a></li>
</ul>
</blockquote>

</div>


  
<div class="prev-next-post pure-g">
  <div class="pure-u-1-24" style="text-align: left;">
    
    <a href="https://yutakikuchi.github.io/post/201205280833/"><i class="fa fa-chevron-left"></i></a>
    
  </div>
  <div class="pure-u-10-24">
    
    <nav class="prev">
      <a href="https://yutakikuchi.github.io/post/201205280833/">標準入出力プログラミング</a>
    </nav>
    
  </div>
  <div class="pure-u-2-24">
    &nbsp;
  </div>
  <div class="pure-u-10-24">
    
    <nav class="next">
      <a href="https://yutakikuchi.github.io/post/201206050830/">より良いプレゼンを行うための５つの改善点</a>
    </nav>
    
  </div>
  <div class="pure-u-1-24" style="text-align: right;">
    
    <a href="https://yutakikuchi.github.io/post/201206050830/"><i class="fa fa-chevron-right"></i></a>
    
  </div>
</div>



  

</div>

</div>
</div>
<script src="https://yutakikuchi.github.io/js/ui.js"></script>
<script src="https://yutakikuchi.github.io/js/menus.js"></script>


<script>
  
  if (window.location.hostname != "localhost") {
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-20616165-3', 'auto');
    ga('send', 'pageview');
  }
</script>





</body>
</html>

