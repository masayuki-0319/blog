<!DOCTYPE html>
<html lang="en">

<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <link rel="canonical" href="http://yut.hatenablog.com/entry/20111209/1323427656" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="">
  <meta name="generator" content="Hugo 0.55.4" />

  <title>HerokuでNodeJSを動かしてみる &middot; Y&#39;s note</title>

  
  
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/pure-min.css">

  <!--[if lte IE 8]>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/grids-responsive-old-ie-min.css">
  <![endif]-->
  <!--[if gt IE 8]><!-->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/grids-responsive-min.css">
  <!--<![endif]-->

  <!--[if lte IE 8]>
  <link rel="stylesheet" href="https://yutakikuchi.github.io/blog/css/side-menu-old-ie.css">
  <![endif]-->
  <!--[if gt IE 8]><!-->
  <link rel="stylesheet" href="https://yutakikuchi.github.io/blog/css/side-menu.css">
  <!--<![endif]-->

  <link rel="stylesheet" href="https://yutakikuchi.github.io/blog/css/blackburn.css">

  
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">

  
  <link href="https://fonts.googleapis.com/css?family=Raleway" rel="stylesheet" type="text/css">

  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

 
  

  
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/androidstudio.min.css">
  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
  
  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/yaml.min.js"></script>
  
  <script>hljs.initHighlightingOnLoad();</script>
  

  <link rel="shortcut icon" href="https://yutakikuchi.github.io/blog/img/favicon.ico" type="image/x-icon" />

  
    
        <link rel="stylesheet" href="https://yutakikuchi.github.io/blog/css/my.css">
    
  
  
    
        <script src="https://yutakikuchi.github.io/blog/js/my.js"></script>
    
  

</head>


<body>
<div id="layout">

  
<a href="#menu" id="menuLink" class="menu-link">
  
  <span></span>
</a>
<div id="menu">

  
  <a class="pure-menu-heading brand" href="https://yutakikuchi.github.io/blog/">Y's note</a>


  <div class="pure-menu">
    <ul class="pure-menu-list">
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://yutakikuchi.github.io/blog/"><i class='fa fa-home fa-fw'></i>Home</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://yutakikuchi.github.io/blog/post/"><i class='fa fa-list fa-fw'></i>Posts</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://yutakikuchi.github.io/blog/about/"><i class='fa fa-user fa-fw'></i>About</a>
      
        </li>
      
    </ul>
  </div>

  <div class="pure-menu social">
  <ul class="pure-menu-list">

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://twitter.com/yutakikuchi_" target="_blank"><i class="fa fa-twitter-square fa-fw"></i>Twitter</a>
    </li>
    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://facebook.com/yuta.kikuchi.007" target="_blank"><i class="fa fa-facebook-square fa-fw"></i>Facebook</a>
    </li>
    

    

    

    

    

    

    

    

    

    

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="http://slideshare.net/https://www.slideshare.net/yutakikuchi58/" target="_blank"><i class="fa fa-slideshare fa-fw"></i>SlideShare</a>
    </li>
    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://linkedin.com/in/https://www.linkedin.com/in/%E4%BD%91%E5%A4%AA-%E8%8F%8A%E6%B1%A0-36291a44/" target="_blank"><i class="fa fa-linkedin-square fa-fw"></i>LinkedIn</a>
    </li>
    

    

    

    

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://github.com/yutakikuchi" target="_blank"><i class="fa fa-github-square fa-fw"></i>GitHub</a>
    </li>
    

    

    

    

    

    

    

    

    

    

    

    

    

  </ul>
</div>


  <div>
  <div class="small-print">
    <small>&copy; 2019. All rights reserved.</small>
  </div>
  <div class="small-print">
    <small>Built with&nbsp;<a href="https://gohugo.io/" target="_blank">Hugo</a></small>
    <small>Theme&nbsp;<a href="https://github.com/yoshiharuyamashita/blackburn" target="_blank">Blackburn</a></small>
  </div>
</div>

</div>


  <div id="main">


<div class="header">
  <h1>HerokuでNodeJSを動かしてみる</h1>
  <h2></h2>
</div>
<div class="content">

  <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>2011 Dec 09, 19:47</time>
  </div>

  

  

  

</div>

  

<h2 id="javascript-herokuでnodejsを動かしてみる">[javascript] : HerokuでNodeJSを動かしてみる</h2>

<p><span itemscope itemtype="http://schema.org/Photograph"><a href="http://f.hatena.ne.jp/yutakikuchi/20111209170812" class="hatena-fotolife" itemprop="url"><img src="http://cdn-ak.f.st-hatena.com/images/fotolife/y/yutakikuchi/20111209/20111209170812.png" alt="f:id:yutakikuchi:20111209170812p:image" title="f:id:yutakikuchi:20111209170812p:image" class="hatena-fotolife" itemprop="image"></a></span><br />
</p>

<div class="section">
<h4><span class="deco" style="font-size:large;">前提</span></h4>

<blockquote>
    
<ul>
<li>Herokuとは？
<ul>
<li><a class="keyword" href="http://d.hatena.ne.jp/keyword/ruby">ruby</a>やnodejsのPaas。ファイルのDeployでアプリケーションを作成することができる。</li>
<li><a class="keyword" href="http://d.hatena.ne.jp/keyword/Google">Google</a>が提供しているGAEや<a class="keyword" href="http://d.hatena.ne.jp/keyword/Windows">Windows</a>のAzureみたいなもの。</li>
<li>少し前に<a class="keyword" href="http://d.hatena.ne.jp/keyword/Salesforce">Salesforce</a>.comに買収されている。</li>
<li>Herokuのアカウント登録は次のURLから  <a href="https://api.heroku.com/signup">https://api.heroku.com/signup</a></li>
<li><a class="keyword" href="http://d.hatena.ne.jp/keyword/GitHub">GitHub</a>でソースを開発/管理して、動作させるのはHerokuサーバ。これが素晴らしい。</li>
<li><a class="keyword" href="http://d.hatena.ne.jp/keyword/%A5%A2%A5%D7%A5%EA%A5%B1%A1%BC%A5%B7%A5%E7%A5%F3%A5%B5%A1%BC%A5%D0">アプリケーションサーバ</a>を1プロセス(dyno)を利用できる。dynoとはHeroku独自の単位。</li>
<li><a class="keyword" href="http://d.hatena.ne.jp/keyword/PostgreSQL">PostgreSQL</a>を5MBまで利用可能。</li>
</ul></li>
<li>この記事の紹介はHerokuのアカウントを保持していること、自分のPCにgem(<a class="keyword" href="http://d.hatena.ne.jp/keyword/Ruby">Ruby</a>のパッケージインストールコマンド),node,npmが入っている事を前提とする。(node,npmあたりは以前記事を書いた <a href="http://d.hatena.ne.jp/yutakikuchi/20110531/1306798231">Node.jsでWebSocketを試してみる - Yuta.Kikuchiの日記</a> <a href="http://b.hatena.ne.jp/entry/d.hatena.ne.jp/yutakikuchi/20110531/1306798231"><img src="http://b.hatena.ne.jp/entry/image/http://d.hatena.ne.jp/yutakikuchi/20110531/1306798231" alt="はてなブックマーク - Node.jsでWebSocketを試してみる - Yuta.Kikuchiの日記" border="0" /></a> を参照して欲しい)</li>
<li><a class="keyword" href="http://d.hatena.ne.jp/keyword/GitHub">GitHub</a>に対する設定と知識も必要。以前<a class="keyword" href="http://d.hatena.ne.jp/keyword/Mac">Mac</a>での設定を書いた。<a href="http://d.hatena.ne.jp/yutakikuchi/20101230/1293740647">MacユーザのためのGitHub登録手順 - Yuta.Kikuchiの日記</a> <a href="http://b.hatena.ne.jp/entry/d.hatena.ne.jp/yutakikuchi/20101230/1293740647"><img src="http://b.hatena.ne.jp/entry/image/http://d.hatena.ne.jp/yutakikuchi/20101230/1293740647" alt="はてなブックマーク - MacユーザのためのGitHub登録手順 - Yuta.Kikuchiの日記" border="0" /></a></li>
<li>私が試した環境は<a class="keyword" href="http://d.hatena.ne.jp/keyword/MacOSX">MacOSX</a>。バージョン10.6.8</li>
</ul>
</blockquote>

</div>
<div class="section">
<h4><span class="deco" style="font-size:large;">準備</span></h4>

<blockquote>
    <p><span itemscope itemtype="http://schema.org/Photograph"><a href="http://f.hatena.ne.jp/yutakikuchi/20111209171015" class="hatena-fotolife" itemprop="url"><img src="http://cdn-ak.f.st-hatena.com/images/fotolife/y/yutakikuchi/20111209/20111209171015.gif" alt="f:id:yutakikuchi:20111209171015g:image" title="f:id:yutakikuchi:20111209171015g:image" class="hatena-fotolife" itemprop="image"></a></span></p>

<div class="section">
<h5>nodejs/npmのバージョン確認</h5>
<pre class="code" data-lang="" data-unlink>$ node -v
v0.4.8

$ npm -v
1.0.6</pre>
</div>
</blockquote>

</div>
<div class="section">
<h4><span class="deco" style="font-size:large;">Herokuパッケージ設定手順</span></h4>

<blockquote>
    
<div class="section">
<h5>Herokuのinstall</h5>
<pre class="code" data-lang="" data-unlink>$ sudo gem update --system
$ sudo install heroku</pre>
</div>
<div class="section">
<h5>アプリ一覧を表示</h5>
<p>まだ何も登録していないのでYou have no apps.と表示される。</p>
<pre class="code" data-lang="" data-unlink>$ heroku list
Enter your Heroku credentials
Email:  hoge@gmail.com
Password: 
Found existing public key: /Users/YutaKikuchi/.ssh/id_rsa.pub
Uploading ssh public key /Users/YutaKikuchi/.ssh/id_rsa.pub
You have no apps.</pre>
</div>
</blockquote>

</div>
<div class="section">
<h4><span class="deco" style="font-size:large;">必要なファイル</span></h4>

<blockquote>
    
<div class="section">
<h5>ファイル構成</h5>
<pre class="code" data-lang="" data-unlink>.git
.gitignore
Procfile
socketchat.js
node_modules
package.json</pre>
</div>
<div class="section">
<h5>Procfile</h5>

<ul>
<li>新しいHerokuの環境となったCedarから取り入れれたファイル。以下のように記述</li>
</ul><pre class="code" data-lang="" data-unlink>web: node socketchat.js</pre>
</div>
<div class="section">
<h5>package.<a class="keyword" href="http://d.hatena.ne.jp/keyword/json">json</a>(Nodeを使う場合に必要)</h5>

<ul>
<li>アプリの説明やNPMの依存を記述する。</li>
</ul><pre class="code" data-lang="" data-unlink>{
  "name": "socketchat",
  "version": "0.0.1",
  "dependencies": {
"express": "2.2.0"
  }
}</pre>
</div>
<div class="section">
<h5>実行するNodejsファイル</h5>

<ul>
<li>socketchat.jsというファイルにて作成。</li>
<li>とりあえず動く事を確認したいのでHerokuにあるサンプルプログラムをそのまま記述する。</li>
</ul><pre class="hljs javascript" data-lang="javascript" data-unlink><span class="synIdentifier">var</span> express = require(<span class="synConstant">'express'</span>);

<span class="synIdentifier">var</span> app = express.createServer(express.logger());

app.get(<span class="synConstant">'/'</span>, <span class="synIdentifier">function</span>(request, response) <span class="synIdentifier">{</span>
  response.send(<span class="synConstant">'Hello World!'</span>);
<span class="synIdentifier">}</span>);

<span class="synIdentifier">var</span> port = process.env.PORT || 3000;
app.listen(port, <span class="synIdentifier">function</span>() <span class="synIdentifier">{</span>
  console.log(<span class="synConstant">"Listening on "</span> + port);
<span class="synIdentifier">}</span>);
</pre>
</div>
<div class="section">
<h5>.gitignore</h5>

<ul>
<li><a class="keyword" href="http://d.hatena.ne.jp/keyword/GitHub">GitHub</a>への登録を無視する設定ファイル。</li>
</ul><pre class="code" data-lang="" data-unlink>node_modules</pre>
</div>
</blockquote>

</div>
<div class="section">
<h4><span class="deco" style="font-size:large;"><a class="keyword" href="http://d.hatena.ne.jp/keyword/GitHub">GitHub</a>への登録</span></h4>

<blockquote>
    
<div class="section">
<h5><a class="keyword" href="http://d.hatena.ne.jp/keyword/localhost">localhost</a>で動作確認</h5>

<ul>
<li>expressを使うのでnpmでinstallしておく</li>
</ul><pre class="code" data-lang="" data-unlink>$ sudo npm install express
mime@1.2.4 ./node_modules/express/node_modules/mime
qs@0.4.0 ./node_modules/express/node_modules/qs
formidable@1.0.8 ./node_modules/express/node_modules/connect/node_modules/formidable
connect@1.8.2 ./node_modules/express/node_modules/connect
express@2.2.0 ./node_modules/express</pre>
<ul>
<li>起動。<a href="http://localhost:3000/">http://localhost:3000/</a>に<a class="keyword" href="http://d.hatena.ne.jp/keyword/Hello%20World">Hello World</a>!が出力される。</li>
</ul><pre class="code" data-lang="" data-unlink>$ node socketchat.js 
Listening on 3000</pre>
</div>
<div class="section">
<h5><a class="keyword" href="http://d.hatena.ne.jp/keyword/GitHub">GitHub</a>にコミット</h5>

<ul>
<li><a class="keyword" href="http://d.hatena.ne.jp/keyword/GitHub">GitHub</a>に登録。</li>
</ul><pre class="code" data-lang="" data-unlink>$ git init
$ git add .
$ git commit -m "init"
$ git remote add origin git@github.com:yutakikuchi/Node.git
$ git push -u origin master</pre>
<ul>
<li><a class="keyword" href="http://d.hatena.ne.jp/keyword/GitHub">GitHub</a>にUPしたソースは次のもの  <a href="https://github.com/yutakikuchi/Node">https://github.com/yutakikuchi/Node</a></li>
</ul>
</div>
</blockquote>

</div>
<div class="section">
<h4><span class="deco" style="font-size:large;">HerokuへDeploy</span></h4>

<blockquote>
    
<div class="section">
<h5>Herokuにアプリケーションを作成</h5>

<ul>
<li>socketchatという名前で登録する。</li>
<li>--stack cedarとすると<span class="deco" style="font-weight:bold;"><appname>.heroku.com</span>というドメインではなく、<span class="deco" style="font-weight:bold;"><appname>.herokuapp.com</span>という名前で作成される。</li>
</ul><pre class="code" data-lang="" data-unlink>$ heroku create socketchat --stack cedar
Creating socketchat... done, stack is cedar
http://socketchat.herokuapp.com/ | git@heroku.com:socketchat.git
Git remote heroku added</pre>
</div>
<div class="section">
<h5>HerokuにアプリケーションをDeploy</h5>
<pre class="code" data-lang="" data-unlink>$ git push heroku master
Counting objects: 10, done.
Delta compression using up to 2 threads.
Compressing objects: 100% (7/7), done.
Writing objects: 100% (10/10), 1022 bytes, done.
Total 10 (delta 1), reused 0 (delta 0)

-----> Heroku receiving push
-----> Node.js app detected
-----> Fetching Node.js binaries
-----> Vendoring node 0.4.7
-----> Installing dependencies with npm 1.0.94
   express@2.2.0 ./node_modules/express 
   ├── qs@0.4.0
   ├── mime@1.2.4
   └── connect@1.8.2
   Dependencies installed
-----> Discovering process types
   Procfile declares types -> web
-----> Compiled slug size is 6.9MB
-----> Launching... done, v4
   http://socketchat.herokuapp.com deployed to Heroku

To git@heroku.com:socketchat.git
 * [new branch]      master -> master</pre>
</div>
<div class="section">
<h5>コマンドラインからブラウザ起動</h5>
<pre class="code" data-lang="" data-unlink>$ heroku open</pre><p><a href="http://socketchat.herokuapp.com/">http://socketchat.herokuapp.com/</a>にてHellow World!が表示されることを確認。</p>

</div>
</blockquote>

</div>
<div class="section">
<h4><span class="deco" style="font-size:large;">次回</span></h4>

<blockquote>
    <p>Nodeを書いてもう少しちゃんと動くものを提供する予定。</p>

</blockquote>

</div>
<div class="section">
<h4><span class="deco" style="font-size:large;">リンク</span></h4>

<blockquote>
    
<ul>
<li><a href="http://www.atmarkit.co.jp/news/201103/03/heroku.html">なぜSalesforceはHerokuを買収したのか？</a></li>
<li><a href="http://devcenter.heroku.com/articles/node-js">Getting Started with Node.js on Heroku/Cedar</a></li>
<li><a href="http://tech.a-listers.jp/2011/06/02/heroku-supports-nodej/">HerokuがNode.jsのサポートを開始</a></li>
<li><a href="http://devcenter.heroku.com/articles/procfile">Declaring and Scaling Process Types with Procfile</a></li>
</ul>
</blockquote>

</div>


  
<div class="prev-next-post pure-g">
  <div class="pure-u-1-24" style="text-align: left;">
    
    <a href="https://yutakikuchi.github.io/blog/post/201112050830/"><i class="fa fa-chevron-left"></i></a>
    
  </div>
  <div class="pure-u-10-24">
    
    <nav class="prev">
      <a href="https://yutakikuchi.github.io/blog/post/201112050830/">CentOSでHadoopを使ってみる</a>
    </nav>
    
  </div>
  <div class="pure-u-2-24">
    &nbsp;
  </div>
  <div class="pure-u-10-24">
    
    <nav class="next">
      <a href="https://yutakikuchi.github.io/blog/post/201112121517/">NLP(自然言語処理)用語まとめ</a>
    </nav>
    
  </div>
  <div class="pure-u-1-24" style="text-align: right;">
    
    <a href="https://yutakikuchi.github.io/blog/post/201112121517/"><i class="fa fa-chevron-right"></i></a>
    
  </div>
</div>



  

</div>

</div>
</div>
<script src="https://yutakikuchi.github.io/blog/js/ui.js"></script>
<script src="https://yutakikuchi.github.io/blog/js/menus.js"></script>


<script>
  
  if (window.location.hostname != "localhost") {
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-20616165-3', 'auto');
    ga('send', 'pageview');
  }
</script>





</body>
</html>

